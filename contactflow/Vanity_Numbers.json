{
  "Version": "2019-10-30",
  "StartAction": "1578aa50-e2ca-4e9e-90a1-fd9b784aae70",
  "Metadata": {
    "entryPointPosition": {
      "x": 40,
      "y": 40
    },
    "ActionMetadata": {
      "1578aa50-e2ca-4e9e-90a1-fd9b784aae70": {
        "position": {
          "x": 135.2,
          "y": 38.4
        },
        "parameters": {
          "HoursOfOperationId": {
            "displayName": "Basic Hours"
          }
        },
        "Hours": {
          "id": "arn:aws:connect:us-east-1:623537709549:instance/6b33432a-056a-4565-8577-a5ef785fb986/operating-hours/88614533-a2fa-4901-a9d8-effb1456e24d",
          "text": "Basic Hours"
        }
      },
      "Non Working Hours": {
        "position": {
          "x": 1152,
          "y": 112.8
        },
        "isFriendlyName": true
      },
      "No Input Received": {
        "position": {
          "x": 2523.2,
          "y": 1008.8
        },
        "isFriendlyName": true
      },
      "9dccf0a0-b87b-4a51-834b-aacc7d65c208": {
        "position": {
          "x": 4100.8,
          "y": 4.8
        }
      },
      "Timeout Loop": {
        "position": {
          "x": 875.2,
          "y": 1010.4
        },
        "isFriendlyName": true
      },
      "3b594dc4-9723-4fc8-ba84-4e1d3574a950": {
        "position": {
          "x": 242.4,
          "y": 302.4
        },
        "overrideConsoleVoice": false
      },
      "Invalid Value": {
        "position": {
          "x": 958.4,
          "y": 493.6
        },
        "isFriendlyName": true
      },
      "Recording Confirmation": {
        "position": {
          "x": 572.8,
          "y": 563.2
        },
        "isFriendlyName": true,
        "conditionMetadata": [
          {
            "id": "9c53894b-2cc4-4945-9443-0eebca90bffc",
            "value": "1"
          },
          {
            "id": "ed391636-9639-4efa-9001-d10e10d0aad2",
            "value": "9"
          }
        ]
      },
      "Timeout Cell Confirm": {
        "position": {
          "x": 1861.6,
          "y": -539.2
        },
        "isFriendlyName": true
      },
      "ad1a1e13-c50e-4566-83d8-0bf9bc32906f": {
        "position": {
          "x": 522.4,
          "y": -195.2
        }
      },
      "Invalid Option Chosen": {
        "position": {
          "x": 1593.6,
          "y": -808.8
        },
        "isFriendlyName": true
      },
      "Set Target Number As Phone Number": {
        "position": {
          "x": 2669.6,
          "y": -400
        },
        "isFriendlyName": true,
        "dynamicParams": []
      },
      "Play Error From Lambda": {
        "position": {
          "x": 3911.2,
          "y": -1065.6
        },
        "isFriendlyName": true
      },
      "518b7741-e60d-4e82-ad77-4aa99de15528": {
        "position": {
          "x": 4233.6,
          "y": -1022.4
        },
        "conditionMetadata": [
          {
            "id": "256335f4-8869-48e0-b384-ee67df5a5ef6",
            "value": "1"
          },
          {
            "id": "6bef58bc-6725-4fc0-ad77-b64ad1adb179",
            "value": "9"
          }
        ]
      },
      "Play Wait Music": {
        "position": {
          "x": 2949.6,
          "y": -719.2
        },
        "isFriendlyName": true
      },
      "Set Attribute": {
        "position": {
          "x": 3308,
          "y": -835.2
        },
        "isFriendlyName": true,
        "parameters": {
          "Attributes": {
            "SSMLResponse": {
              "useDynamic": true
            },
            "LambdaError": {
              "useDynamic": true
            }
          }
        },
        "dynamicParams": [
          "SSMLResponse",
          "LambdaError"
        ]
      },
      "Generate Vanity Lambda": {
        "position": {
          "x": 3017.6,
          "y": -440
        },
        "isFriendlyName": true,
        "parameters": {
          "LambdaFunctionARN": {
            "displayName": "generate-vanity-numbers"
          }
        },
        "dynamicMetadata": {}
      },
      "Lambda Error Check": {
        "position": {
          "x": 3588.8,
          "y": -903.2
        },
        "isFriendlyName": true,
        "conditions": [],
        "conditionMetadata": [
          {
            "id": "ebafcbb7-3173-410d-ad89-4cdc3aa41f62",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "true"
          },
          {
            "id": "f0f41a26-0fa3-41d2-b5b3-e91e0399647d",
            "operator": {
              "name": "Equals",
              "value": "Equals",
              "shortDisplay": "="
            },
            "value": "false"
          }
        ]
      },
      "Play Generated Vanity Numbers": {
        "position": {
          "x": 3880,
          "y": -792
        },
        "isFriendlyName": true
      },
      "Good Bye": {
        "position": {
          "x": 3546.4,
          "y": 765.6
        },
        "isFriendlyName": true
      },
      "RePlay Generated Vanity Numbers": {
        "position": {
          "x": 4237.6,
          "y": -581.6
        },
        "isFriendlyName": true
      },
      "Input Repeat Vanity Numbers": {
        "position": {
          "x": 3884,
          "y": -412
        },
        "isFriendlyName": true,
        "conditionMetadata": [
          {
            "id": "6e77c904-4c5e-4e2a-9cbb-e1e29738cb51",
            "value": "1"
          },
          {
            "id": "a07c597b-47ab-4771-ba2f-5acf73210699",
            "value": "9"
          }
        ]
      },
      "Invalid Number Entered": {
        "position": {
          "x": 2612,
          "y": -902.4
        },
        "isFriendlyName": true
      },
      "Set Target Number To Be Converted": {
        "position": {
          "x": 2656,
          "y": -636
        },
        "isFriendlyName": true,
        "dynamicParams": []
      },
      "Cell Number Confirmation": {
        "position": {
          "x": 1415.2,
          "y": -316.8
        },
        "isFriendlyName": true,
        "conditionMetadata": [
          {
            "id": "b479446a-d559-4f9d-83b4-aa2ed79cabae",
            "value": "1"
          },
          {
            "id": "8cfbaa61-7667-4abb-9384-83d12237be4c",
            "value": "9"
          },
          {
            "id": "08571d51-e8d7-41ea-8f1b-0a471ee47b06",
            "value": "3"
          }
        ]
      },
      "Error Prompt": {
        "position": {
          "x": 3332.8,
          "y": 342.4
        },
        "isFriendlyName": true
      },
      "Get Custom Phone Number": {
        "position": {
          "x": 2280.8,
          "y": -767.2
        },
        "isFriendlyName": true,
        "conditionMetadata": [],
        "countryCodePrefix": "+1"
      }
    },
    "Annotations": [],
    "name": "Vanity_Numbers",
    "description": "",
    "type": "contactFlow",
    "status": "PUBLISHED",
    "hash": {}
  },
  "Actions": [
    {
      "Parameters": {
        "HoursOfOperationId": "arn:aws:connect:us-east-1:623537709549:instance/6b33432a-056a-4565-8577-a5ef785fb986/operating-hours/88614533-a2fa-4901-a9d8-effb1456e24d"
      },
      "Identifier": "1578aa50-e2ca-4e9e-90a1-fd9b784aae70",
      "Type": "CheckHoursOfOperation",
      "Transitions": {
        "NextAction": "Error Prompt",
        "Conditions": [
          {
            "NextAction": "3b594dc4-9723-4fc8-ba84-4e1d3574a950",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "True"
              ]
            }
          },
          {
            "NextAction": "Non Working Hours",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "False"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>\n  Our <emphasis level=\"moderate\">operating hours</emphasis> are from \n  <say-as interpret-as=\"time\">6:00AM</say-as> to \n  <say-as interpret-as=\"time\">12:00AM</say-as>. \n  Please call us during these hours. \n  <break time=\"500ms\"/>\n  Thank you.\n</speak>"
      },
      "Identifier": "Non Working Hours",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>\n    <prosody rate=\"medium\" volume=\"medium\">\n        No input received, the call will be automatically terminated.\n    </prosody>\n</speak>"
      },
      "Identifier": "No Input Received",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Good Bye",
        "Errors": [
          {
            "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {},
      "Identifier": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
      "Type": "DisconnectParticipant",
      "Transitions": {}
    },
    {
      "Parameters": {
        "LoopCount": "2"
      },
      "Identifier": "Timeout Loop",
      "Type": "Loop",
      "Transitions": {
        "NextAction": "No Input Received",
        "Conditions": [
          {
            "NextAction": "Recording Confirmation",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ContinueLooping"
              ]
            }
          },
          {
            "NextAction": "No Input Received",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "DoneLooping"
              ]
            }
          }
        ]
      }
    },
    {
      "Parameters": {
        "TextToSpeechVoice": "Joanna"
      },
      "Identifier": "3b594dc4-9723-4fc8-ba84-4e1d3574a950",
      "Type": "UpdateContactTextToSpeechVoice",
      "Transitions": {
        "NextAction": "Recording Confirmation",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>Invalid value selected. Please reselect.</speak>"
      },
      "Identifier": "Invalid Value",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Recording Confirmation",
        "Errors": [
          {
            "NextAction": "Recording Confirmation",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "False",
        "InputTimeLimitSeconds": "5",
        "SSML": "<speak>\nThank you for calling Manny's Vanity Phone number service. \n  <break time=\"500ms\"/> \n  This call <emphasis level=\"moderate\">will be recorded</emphasis> for quality and analysis purposes. \n  <break time=\"500ms\"/> \nYour cell number will be stored on record.\n  <break time=\"500ms\"/> \n  Please press <say-as interpret-as=\"digits\">1</say-as> to confirm, or \n  <say-as interpret-as=\"digits\">9</say-as> to disconnect.\n</speak>"
      },
      "Identifier": "Recording Confirmation",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "Invalid Value",
        "Conditions": [
          {
            "NextAction": "ad1a1e13-c50e-4566-83d8-0bf9bc32906f",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "Good Bye",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "9"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Timeout Loop",
            "ErrorType": "InputTimeLimitExceeded"
          },
          {
            "NextAction": "Invalid Value",
            "ErrorType": "NoMatchingCondition"
          },
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "LoopCount": "2"
      },
      "Identifier": "Timeout Cell Confirm",
      "Type": "Loop",
      "Transitions": {
        "NextAction": "No Input Received",
        "Conditions": [
          {
            "NextAction": "Cell Number Confirmation",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "ContinueLooping"
              ]
            }
          },
          {
            "NextAction": "No Input Received",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "DoneLooping"
              ]
            }
          }
        ]
      }
    },
    {
      "Parameters": {
        "RecordingBehavior": {
          "RecordedParticipants": [
            "Agent",
            "Customer"
          ],
          "IVRRecordingBehavior": "Enabled"
        }
      },
      "Identifier": "ad1a1e13-c50e-4566-83d8-0bf9bc32906f",
      "Type": "UpdateContactRecordingBehavior",
      "Transitions": {
        "NextAction": "Cell Number Confirmation"
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>Invalid option chosen. Please enter a vaild option.</speak>"
      },
      "Identifier": "Invalid Option Chosen",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Cell Number Confirmation",
        "Errors": [
          {
            "NextAction": "Cell Number Confirmation",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "TargetNumber": "$.CustomerEndpoint.Address"
        },
        "TargetContact": "Current"
      },
      "Identifier": "Set Target Number As Phone Number",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Play Wait Music",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "$.Attributes.SSMLResponse"
      },
      "Identifier": "Play Error From Lambda",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "518b7741-e60d-4e82-ad77-4aa99de15528",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "False",
        "InputTimeLimitSeconds": "4",
        "SSML": "<speak>Do you want to enter another number?\nPress 1 for yes\nPress 9 for no\n</speak>"
      },
      "Identifier": "518b7741-e60d-4e82-ad77-4aa99de15528",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "Good Bye",
        "Conditions": [
          {
            "NextAction": "Cell Number Confirmation",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "Good Bye",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "9"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Good Bye",
            "ErrorType": "InputTimeLimitExceeded"
          },
          {
            "NextAction": "Good Bye",
            "ErrorType": "NoMatchingCondition"
          },
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>Please hold while we generate your numbers.</speak>"
      },
      "Identifier": "Play Wait Music",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Generate Vanity Lambda",
        "Errors": [
          {
            "NextAction": "Generate Vanity Lambda",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "SSMLResponse": "$.External.ssmlResponse",
          "LambdaError": "$.External.ssmlError"
        },
        "TargetContact": "Current"
      },
      "Identifier": "Set Attribute",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Lambda Error Check",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "LambdaFunctionARN": "arn:aws:lambda:us-east-1:623537709549:function:generate-vanity-numbers",
        "InvocationTimeLimitSeconds": "8",
        "ResponseValidation": {
          "ResponseType": "JSON"
        }
      },
      "Identifier": "Generate Vanity Lambda",
      "Type": "InvokeLambdaFunction",
      "Transitions": {
        "NextAction": "Set Attribute",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "ComparisonValue": "$.Attributes.LambdaError"
      },
      "Identifier": "Lambda Error Check",
      "Type": "Compare",
      "Transitions": {
        "NextAction": "Error Prompt",
        "Conditions": [
          {
            "NextAction": "Play Error From Lambda",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "true"
              ]
            }
          },
          {
            "NextAction": "Play Generated Vanity Numbers",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "false"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingCondition"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "$.Attributes.SSMLResponse"
      },
      "Identifier": "Play Generated Vanity Numbers",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Input Repeat Vanity Numbers",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>\n  <prosody rate=\"medium\" pitch=\"medium\">\n    <emphasis level=\"moderate\">Thank you</emphasis> for calling \n    <break time=\"200ms\"/>\n    Manny's Vanity Number Service. \n    <break time=\"500ms\"/>\n    <emphasis level=\"moderate\">Goodbye</emphasis>, and have a wonderful day!\n  </prosody>\n</speak>"
      },
      "Identifier": "Good Bye",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
        "Errors": [
          {
            "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "$.Attributes.SSMLResponse"
      },
      "Identifier": "RePlay Generated Vanity Numbers",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Good Bye",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "False",
        "InputTimeLimitSeconds": "5",
        "SSML": "<speak>\n  To hear this information again, press <say-as interpret-as=\"digits\">1</say-as>.\n  <break time=\"0.5s\"/>\n  To exit, press <say-as interpret-as=\"digits\">9</say-as>.\n</speak>"
      },
      "Identifier": "Input Repeat Vanity Numbers",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "RePlay Generated Vanity Numbers",
        "Conditions": [
          {
            "NextAction": "RePlay Generated Vanity Numbers",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "Good Bye",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "9"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Good Bye",
            "ErrorType": "InputTimeLimitExceeded"
          },
          {
            "NextAction": "RePlay Generated Vanity Numbers",
            "ErrorType": "NoMatchingCondition"
          },
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>Invalid Number Entered. Please re enter the phone number.</speak>"
      },
      "Identifier": "Invalid Number Entered",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "Get Custom Phone Number",
        "Errors": [
          {
            "NextAction": "Get Custom Phone Number",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "Attributes": {
          "TargetNumber": "$.StoredCustomerInput"
        },
        "TargetContact": "Current"
      },
      "Identifier": "Set Target Number To Be Converted",
      "Type": "UpdateContactAttributes",
      "Transitions": {
        "NextAction": "Play Wait Music",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "False",
        "InputTimeLimitSeconds": "5",
        "SSML": "<speak>\nThe phone number you are calling from is:\n    <say-as interpret-as=\"telephone\">$.CustomerEndpoint.Address</say-as>  \n  <break time=\"400ms\"/>\n  Please press <say-as interpret-as=\"digits\">1</say-as> to use this number. \n  <break time=\"500ms\"/>\n  Press <say-as interpret-as=\"digits\">3</say-as> to manually enter a number, or \n  <break time=\"500ms\"/>\n  press <say-as interpret-as=\"digits\">9</say-as> to disconnect.\n</speak>"
      },
      "Identifier": "Cell Number Confirmation",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "Invalid Option Chosen",
        "Conditions": [
          {
            "NextAction": "Set Target Number As Phone Number",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "1"
              ]
            }
          },
          {
            "NextAction": "Good Bye",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "9"
              ]
            }
          },
          {
            "NextAction": "Get Custom Phone Number",
            "Condition": {
              "Operator": "Equals",
              "Operands": [
                "3"
              ]
            }
          }
        ],
        "Errors": [
          {
            "NextAction": "Timeout Cell Confirm",
            "ErrorType": "InputTimeLimitExceeded"
          },
          {
            "NextAction": "Invalid Option Chosen",
            "ErrorType": "NoMatchingCondition"
          },
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "SSML": "<speak>The service is currently unavailable. We apologize for the inconvenience. Please try again later or contact us at a different time.</speak>"
      },
      "Identifier": "Error Prompt",
      "Type": "MessageParticipant",
      "Transitions": {
        "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
        "Errors": [
          {
            "NextAction": "9dccf0a0-b87b-4a51-834b-aacc7d65c208",
            "ErrorType": "NoMatchingError"
          }
        ]
      }
    },
    {
      "Parameters": {
        "StoreInput": "True",
        "InputTimeLimitSeconds": "5",
        "SSML": "<speak>Please enter the 10-digit phone number without international code.</speak>",
        "DTMFConfiguration": {
          "InterdigitTimeLimitSeconds": "4"
        },
        "InputValidation": {
          "PhoneNumberValidation": {
            "NumberFormat": "Local",
            "CountryCode": "US"
          }
        }
      },
      "Identifier": "Get Custom Phone Number",
      "Type": "GetParticipantInput",
      "Transitions": {
        "NextAction": "Set Target Number To Be Converted",
        "Errors": [
          {
            "NextAction": "Error Prompt",
            "ErrorType": "NoMatchingError"
          },
          {
            "NextAction": "Invalid Number Entered",
            "ErrorType": "InvalidPhoneNumber"
          }
        ]
      }
    }
  ]
}